(function(t,o,n){typeof define=="function"&&define.amd?define(["jquery"],function(e){return n(e,t,o),e.mobile}):n(t.jQuery,t,o)})(this,document,function(e,t,n,o){(function(h,j,e,f){function v(e){while(e&&typeof e.originalEvent!="undefined")e=e.originalEvent;return e}function i(e,t){var o=e.type,n,i,s,a,r,c,u,l,p;e=h.Event(e),e.type=t,n=e.originalEvent,i=[],o.search(/^(mouse|click)/)>-1&&(i=q);if(n)for(u=i.length,a;u;)a=i[--u],e[a]=n[a];o.search(/mouse(down|up)|click/)>-1&&!e.which&&(e.which=1);if(o.search(/^touch/)!==-1){s=v(n),o=s.touches,r=s.changedTouches,c=o&&o.length?o[0]:r&&r.length?r[0]:f;if(c)for(l=0,p=E.length;l<p;l++)a=E[l],e[a]=c[a]}return e}function s(e){var t={},o,n;while(e){o=h.data(e,b);for(n in o)o[n]&&(t[n]=t.hasVirtualBinding=!0);e=e.parentNode}return t}function a(e,t){var o;while(e){o=h.data(e,b);if(o&&(!t||o[t]))return e;e=e.parentNode}return null}function t(){x=!1}function r(){x=!0}function z(){O=0,M.length=0,I=!1,r()}function F(){t()}function c(){u(),n=setTimeout(function(){n=0,z()},h.vmouse.resetTimerDuration)}function u(){n&&(clearTimeout(n),n=0)}function l(e,t,o){var n;if(o&&o[e]||!o&&a(t.target,e))n=i(t,e),h(t.target).trigger(n);return n}function p(e){var t=h.data(e.target,y),o;!I&&(!O||O!==t)&&(o=l("v"+e.type,e),o&&(o.isDefaultPrevented()&&e.preventDefault(),o.isPropagationStopped()&&e.stopPropagation(),o.isImmediatePropagationStopped()&&e.stopImmediatePropagation()))}function d(e){var t=v(e).touches,o,n,i;t&&t.length===1&&(o=e.target,n=s(o),n.hasVirtualBinding&&(O=Q++,h.data(o,y,O),u(),F(),k=!1,i=v(e).touches[0],X=i.pageX,Y=i.pageY,l("vmouseover",e,n),l("vmousedown",e,n)))}function m(e){if(x)return;k||l("vmousecancel",e,s(e.target)),k=!0,c()}function g(e){if(x)return;var t=v(e).touches[0],o=k,n=h.vmouse.moveDistanceThreshold,i=s(e.target);k=k||Math.abs(t.pageX-X)>n||Math.abs(t.pageY-Y)>n,k&&!o&&l("vmousecancel",e,i),l("vmousemove",e,i),c()}function w(e){if(x)return;r();var t=s(e.target),o,n;l("vmouseup",e,t),k||(o=l("vclick",e,t),o&&o.isDefaultPrevented()&&(n=v(e).changedTouches[0],M.push({touchID:O,x:n.clientX,y:n.clientY}),I=!0)),l("vmouseout",e,t),k=!1,c()}function T(e){var t=h.data(e,b),o;if(t)for(o in t)if(t[o])return!0;return!1}function D(){}function H(o){var n=o.substr(1);return{setup:function(){T(this)||h.data(this,b,{});var e=h.data(this,b);e[o]=!0,P[o]=(P[o]||0)+1,P[o]===1&&L.on(n,p),h(this).on(n,D),S&&(P.touchstart=(P.touchstart||0)+1,P.touchstart===1&&L.on("touchstart",d).on("touchend",w).on("touchmove",g).on("scroll",m))},teardown:function(){--P[o],P[o]||L.off(n,p),S&&(--P.touchstart,P.touchstart||L.off("touchstart",d).off("touchmove",g).off("touchend",w).off("scroll",m));var e=h(this),t=h.data(this,b);t&&(t[o]=!1),e.off(n,D),T(this)||e.removeData(b)}}}var b="virtualMouseBindings",y="virtualTouchID",o="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),E="clientX clientY pageX pageY screenX screenY".split(" "),V=h.event.mouseHooks?h.event.mouseHooks.props:[],q=[],P={},n=0,X=0,Y=0,k=!1,M=[],I=!1,x=!1,S="addEventListener"in e,L=h(e),Q=1,O=0,B,N;h.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500};for(N=0;N<o.length;N++)h.event.special[o[N]]=H(o[N]);S&&e.addEventListener("click",function(e){var t=M.length,o=e.target,n,i,s,a,r,c;if(t){n=e.clientX,i=e.clientY,B=h.vmouse.clickDistanceThreshold,s=o;while(s){for(a=0;a<t;a++){r=M[a],c=0;if(s===o&&Math.abs(r.x-n)<B&&Math.abs(r.y-i)<B||h.data(s,y)===r.touchID){e.preventDefault(),e.stopPropagation();return}}s=s.parentNode}}},!0)})(e,t,n),function(e){e.mobile={}}(e),function(e,t){var o={touch:"ontouchend"in n};e.mobile.support=e.mobile.support||{},e.extend(e.support,o),e.extend(e.mobile.support,o)}(e),function(u,s,a){function l(e,t,o,n){var i=o.type;o.type=t,n?u.event.trigger(o,a,e):u.event.dispatch.call(e,o),o.type=i}var p=u(n),e=u.mobile.support.touch,r="touchmove scroll",o=e?"touchstart":"mousedown",c=e?"touchend":"mouseup",h=e?"touchmove":"mousemove";u.each("touchstart touchmove touchend tap taphold swipe swipeleft swiperight scrollstart scrollstop".split(" "),function(e,t){u.fn[t]=function(e){return e?this.on(t,e):this.trigger(t)},u.attrFn&&(u.attrFn[t]=!0)}),u.event.special.scrollstart={enabled:!0,setup:function(){function t(e,t){n=t,l(o,n?"scrollstart":"scrollstop",e)}var o=this,e=u(o),n,i;e.on(r,function(e){if(!u.event.special.scrollstart.enabled)return;n||t(e,!0),clearTimeout(i),i=setTimeout(function(){t(e,!1)},50)})},teardown:function(){u(this).off(r)}},u.event.special.tap={tapholdThreshold:750,emitTapOnTaphold:!0,setup:function(){var a=this,r=u(a),c=!1;r.on("vmousedown",function(e){function t(){clearTimeout(s)}function o(){t(),r.off("vclick",n).off("vmouseup",t),p.off("vmousecancel",o)}function n(e){o(),!c&&i===e.target?l(a,"tap",e):c&&e.preventDefault()}c=!1;if(e.which&&e.which!==1)return!1;var i=e.target,s;r.on("vmouseup",t).on("vclick",n),p.on("vmousecancel",o),s=setTimeout(function(){u.event.special.tap.emitTapOnTaphold||(c=!0),l(a,"taphold",u.Event("taphold",{target:i}))},u.event.special.tap.tapholdThreshold)})},teardown:function(){u(this).off("vmousedown").off("vclick").off("vmouseup"),p.off("vmousecancel")}},u.event.special.swipe={scrollSupressionThreshold:30,durationThreshold:1e3,horizontalDistanceThreshold:30,verticalDistanceThreshold:30,getLocation:function(e){var t=s.pageXOffset,o=s.pageYOffset,n=e.clientX,i=e.clientY;if(e.pageY===0&&Math.floor(i)>Math.floor(e.pageY)||e.pageX===0&&Math.floor(n)>Math.floor(e.pageX))n-=t,i-=o;else if(i<e.pageY-o||n<e.pageX-t)n=e.pageX-t,i=e.pageY-o;return{x:n,y:i}},start:function(e){var t=e.originalEvent.touches?e.originalEvent.touches[0]:e,o=u.event.special.swipe.getLocation(t);return{time:(new Date).getTime(),coords:[o.x,o.y],origin:u(e.target)}},stop:function(e){var t=e.originalEvent.touches?e.originalEvent.touches[0]:e,o=u.event.special.swipe.getLocation(t);return{time:(new Date).getTime(),coords:[o.x,o.y]}},handleSwipe:function(e,t,o,n){if(t.time-e.time<u.event.special.swipe.durationThreshold&&Math.abs(e.coords[0]-t.coords[0])>u.event.special.swipe.horizontalDistanceThreshold&&Math.abs(e.coords[1]-t.coords[1])<u.event.special.swipe.verticalDistanceThreshold){var i=e.coords[0]>t.coords[0]?"swipeleft":"swiperight";return l(o,"swipe",u.Event("swipe",{target:n,swipestart:e,swipestop:t}),!0),l(o,i,u.Event(i,{target:n,swipestart:e,swipestop:t}),!0),!0}return!1},eventInProgress:!1,setup:function(){var e,s=this,t=u(s),a={};e=u.data(this,"mobile-events"),e||(e={length:0},u.data(this,"mobile-events",e)),e.length++,e.swipe=a,a.start=function(e){if(u.event.special.swipe.eventInProgress)return;u.event.special.swipe.eventInProgress=!0;var t,o=u.event.special.swipe.start(e),n=e.target,i=!1;a.move=function(e){if(!o||e.isDefaultPrevented())return;t=u.event.special.swipe.stop(e),i||(i=u.event.special.swipe.handleSwipe(o,t,s,n),i&&(u.event.special.swipe.eventInProgress=!1)),Math.abs(o.coords[0]-t.coords[0])>u.event.special.swipe.scrollSupressionThreshold&&e.preventDefault()},a.stop=function(){i=!0,u.event.special.swipe.eventInProgress=!1,p.off(h,a.move),a.move=null},p.on(h,a.move).one(c,a.stop)},t.on(o,a.start)},teardown:function(){var e,t;e=u.data(this,"mobile-events"),e&&(t=e.swipe,delete e.swipe,e.length--,e.length===0&&u.removeData(this,"mobile-events")),t&&(t.start&&u(this).off(o,t.start),t.move&&p.off(h,t.move),t.stop&&p.off(c,t.stop))}},u.each({scrollstop:"scrollstart",taphold:"tap",swipeleft:"swipe.left",swiperight:"swipe.right"},function(e,t){u.event.special[e]={setup:function(){u(this).on(t,u.noop)},teardown:function(){u(this).off(t)}}})}(e,this)});